<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recuperación desde varios documentos HTML</title>
</head>
<body>
    <h1>Recuperación de un texto mediante Ajax</h1>
    <input type="button" value="Pulsa para mostrar el texto recuperado en el div inferior" onclick="recuperaTextos();">
    <div id="zona_recuperacion1">
        <!--Aquí dentro crearemos desde js un párrafo con el texto recuperado introducido con innerHTML-->
    </div>
    <div id="zona_recuperacion2">
        <!--Aquí dentro crearemos desde js un párrafo con el texto recuperado introducido con innerHTML-->
    </div>
    <script>
        /*En este tutorial recuperamos el contenido de un documento txt y lo mostramos en nuestra página sin refrescar al pulsar un botón*/
        function recuperaTextos(){
            recuperaTexto1();
            recuperaTexto2();
        }
        function recuperaTexto1(){
            
            xhttp.onreadystatechange = function(){//Cuando ese objeto cambie de estado, haremos lo que introduzcamos en esta función anónima
                //Como el cambio no tiene por qué ser a nuestro favor, debemos comprobar que recuperamos un 4 y un 200
                if(xhttp.readyState == 4 && xhttp.status ==200){ //Si la conexión ha sido un éxito...
                    document.getElementById("zona_recuperacion1").innerHTML=xhttp.responseText;//Insertamos los valores recuperados (Una página html) en el interior de este div
                }else{//Si hemos fallado en la conexión y recuperación de esa información
                    document.getElementById("zona_de_recuperacion1").innerHTML="<p>Ha habido un error, esperábamos respuesta 4-200 y hemos recibido "+this.readyState+" - "+this.status+"</p>";
                }
            };
            xhttp.open("GET", "http://localhost/ajax/tutorial/ajax07_doc1.html", true); //Recibe el método (post o get), la url del fichero a recuperar y true o false a la pregunta de si queremos que sea asínscrono. Si no es asíncrono no es AJAX
            xhttp.send(null);
        }
        function recuperaTexto2(){
            const xhttp = new XMLHttpRequest(); //Creamos el objeto ajax
            xhttp.onreadystatechange = function(){//Cuando ese objeto cambie de estado, haremos lo que introduzcamos en esta función anónima
                //Como el cambio no tiene por qué ser a nuestro favor, debemos comprobar que recuperamos un 4 y un 200
                if(xhttp.readyState == 4 && xhttp.status == 200){ //Si la conexión ha sido un éxito...
                    document.getElementById("zona_recuperacion2").innerHTML=xhttp.responseText;//Insertamos los valores recuperados (Una página html) en el interior de este div
                }else{//Si hemos fallado en la conexión y recuperación de esa información
                    document.getElementById("zona_de_recuperacion2").innerHTML="<p>Ha habido un error, esperábamos respuesta 4-200 y hemos recibido "+this.readyState+" - "+this.status+"</p>";
                }
            };
            xhttp.open("GET", "http://localhost/ajax/tutorial/ajax07_doc2.html", true); //Recibe el método (post o get), la url del fichero a recuperar y true o false a la pregunta de si queremos que sea asínscrono. Si no es asíncrono no es AJAX
            xhttp.send(null);
        }
    </script>
</body>
</html>